type AllowList @table(database: "data") @export {
    id: ID @primaryKey @indexed
    tokenRef: String @indexed
    route: String
    clientIp: String
    note: String
    createdBy: String!
    createdAt: Date
    isArchived: Boolean
    updatedAt: Date
}

type Administrator @table(database: "data") @export {
    id: ID @primaryKey @indexed
    login: String! @indexed
    secret: String!
    sessionKey: String
    role: String!
    state: String!
    createdBy: String!
    createdAt: Date
    updatedAt: Date
}

type AccessPolicy @table(database: "data") @export {
    id: ID @primaryKey @indexed
    reasonRef: String! @indexed
    details: String
    status: String! @indexed
    rules: Any
    updatedAt: Date
}

type Reason @table(database: "data") @export {
    id: ID @primaryKey @indexed
    label: String!
    status: String!
}

type RevokedToken @table(database: "data") @export {
    tokenKey: String @primaryKey @indexed
    reasonRef: String!
    revokedBy: String!
    revokedOn: Date
    comment: String
}

type AccessLog @table(database: "data", replicate: false) @export {
    id: Long @primaryKey
    tokenKey: String @indexed
    userRef: String
    route: String
    clientIp: String
    deviceRef: String
    occurredAt: Long @indexed
    region: String
    expiresAt: Long @indexed
}

type ApiToken @table(database: "data", replicate: false) @export {
    tokenKey: String @primaryKey @indexed
    concurrent: Int @indexed
    hits1min: Int @indexed
    hits5min: Int @indexed
    hits15min: Int @indexed
    updatedAt: Date @indexed
    reasonRef: String!
    updatedBy: String!
    updatedOn: Date @indexed
    comment: String
    userRef: String @indexed
}

type AuditEvent @table(database: "data", replicate: false) @export {
    eventId: String @primaryKey @indexed
    actor: String!
    action: String!
    entity: String
    entityId: String
    payload: any
    occurredOn: Date! @indexed
}
