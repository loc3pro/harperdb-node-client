type Whitelist @table(database: "data") @export {
    id: ID @primaryKey @indexed
    tokenId: String @indexed
    path: String
    requestIp: String
    reason: String
    createdBy: String!
    createdOn: Date
    isDeleted: Boolean
    lastUpdated: Date
}

type Admin @table(database: "data") @export {
    id: ID @primaryKey @indexed
    username: String! @indexed
    password: String!
    refreshToken: String
    role: String!
    status: String!
    createdBy: String!
    createdOn: Date
    lastUpdated: Date
}

type Policy @table(database: "data") @export {
    id: ID @primaryKey @indexed
    banReasonId: String! @indexed
    description: String
    status: String! @indexed
    ruleStructure: Any
    lastUpdated: Date
}

type BanReason @table(database: "data") @export {
    id: ID @primaryKey @indexed
    description: String!
    status: String!
}

type BannedToken @table(database: "data") @export {
    tokenId: String @primaryKey @indexed
    banReasonId: String!
    bannedBy: String!
    bannedOn: Date
    note: String
}

type TokenLog @table(database: "data", replicate: false) @export {
    id: Long @primaryKey
    tokenId: String @indexed
    userId: String
    path: String
    requestIp: String
    deviceId: String
    timestamp: Long @indexed
    region: String
    expiredAt: Long @indexed
}

type Token @table(database: "data", replicate: false) @export {
    tokenId: String @primaryKey @indexed
    concurrent: Int @indexed
    hits1min: Int @indexed
    hits5min: Int @indexed
    hits15min: Int @indexed
    lastUpdated: Date @indexed
    banReasonId: String!
    bannedBy: String!
    bannedOn: Date @indexed
    note: String
    userId: String @indexed
}

type AuditTrail @table(database: "data", replicate: false) @export {
    trailId: String @primaryKey @indexed
    actionBy: String!
    actionType: String!
    objectName: String
    objectId: String
    additionalData: any
    actionAt: Date! @indexed
}
